{"version":5,"vars":[{"name":"Pki::Controller::Pki","definition":1,"line":0,"kind":2},{"name":"Base","containerName":"Mojo","kind":2,"line":1},{"name":"JSON","containerName":"Config","kind":2,"line":3},{"containerName":"Data","name":"Printer","line":4,"kind":2},{"kind":2,"line":5,"name":"DateTime","containerName":""},{"name":"JSON","containerName":"","kind":2,"line":6},{"name":"Search","containerName":"Pod::Simple","kind":2,"line":7},{"kind":2,"line":8,"containerName":"MetaCPAN::Pod","name":"XHTML"},{"name":"DBI","containerName":"","line":10,"kind":2},{"line":11,"definition":"my","name":"$dbh","localvar":"my","kind":13,"containerName":null},{"name":"DBI","kind":12,"line":11},{"name":"connect","containerName":"Pki::Controller::Pki","line":11,"kind":12},{"definition":"sub","line":17,"signature":{"parameters":[{"label":"$self"}],"label":"critic($self)","documentation":"1;\npackage Pki::Controller::Pki;\nuse Mojo::Base 'Mojolicious::Controller';\n\nuse Config::JSON;\nuse Data::Printer;\nuse DateTime;\nuse JSON;\nuse Pod::Simple::Search;\nuse MetaCPAN::Pod::XHTML;\n\nuse DBI;\nmy $dbh = DBI->connect(\"dbi:SQLite:critic.db\",\"\",\"\") or die \"Could not connect\";\n\n=head2 critic"},"name":"critic","children":[{"kind":13,"containerName":"critic","localvar":"my","definition":"my","line":18,"name":"$self"},{"containerName":"critic","kind":13,"localvar":"my","name":"$module","definition":"my","line":20},{"name":"$self","containerName":"critic","line":20,"kind":13},{"kind":12,"line":20,"name":"param","containerName":"critic"},{"kind":13,"containerName":"critic","line":21,"definition":"my","name":"@critics","localvar":"my"},{"containerName":"critic","kind":13,"localvar":"my","name":"$critic_query","line":23,"definition":"my"},{"containerName":"critic","kind":13,"name":"$critic_stmt","line":24,"definition":"my","localvar":"my"},{"line":24,"kind":13,"containerName":"critic","name":"$dbh"},{"name":"prepare","containerName":"critic","kind":12,"line":24},{"name":"$critic_query","containerName":"critic","line":24,"kind":13},{"containerName":"critic","name":"$critic_stmt","line":25,"kind":13},{"line":25,"kind":12,"containerName":"critic","name":"execute"},{"containerName":"critic","name":"$module","line":25,"kind":13},{"name":"$module","definition":"my","line":26,"localvar":"my","containerName":"critic","kind":13},{"containerName":"critic","name":"$critic","kind":13,"line":26},{"name":"$line_number","containerName":"critic","line":26,"kind":13},{"name":"$source","containerName":"critic","line":26,"kind":13},{"containerName":"critic","name":"$explanation","line":26,"kind":13},{"line":26,"kind":13,"name":"$critic_stmt","containerName":"critic"},{"kind":12,"line":26,"containerName":"critic","name":"fetchrow_array"},{"line":27,"kind":13,"name":"@critics","containerName":"critic"},{"name":"$line_number","containerName":"critic","kind":13,"line":27},{"line":27,"kind":13,"containerName":"critic","name":"$critic"},{"name":"$source","containerName":"critic","kind":13,"line":27},{"name":"$explanation","containerName":"critic","line":27,"kind":13},{"localvar":"my","definition":"my","line":30,"name":"$critic_data","kind":13,"containerName":"critic"},{"name":"@critics","containerName":"critic","kind":13,"line":30},{"line":32,"kind":13,"containerName":"critic","name":"$self"},{"containerName":"critic","name":"render","line":32,"kind":12},{"line":32,"kind":13,"containerName":"critic","name":"$critic_data"}],"kind":12,"containerName":"Pki::Controller::Pki","detail":"($self)","range":{"end":{"line":33,"character":9999},"start":{"line":17,"character":0}}},{"line":27,"kind":12,"name":"line_number"},{"kind":12,"line":27,"name":"critic"},{"name":"source","kind":12,"line":27},{"name":"explanation","kind":12,"line":27},{"name":"data","kind":12,"line":30},{"kind":12,"line":32,"name":"json"},{"kind":12,"containerName":"Pki::Controller::Pki","range":{"start":{"line":39,"character":0},"end":{"character":9999,"line":59}},"children":[{"kind":13,"containerName":"git_commit_stats","localvar":"my","definition":"my","line":40,"name":"$self"},{"containerName":"git_commit_stats","kind":13,"name":"@data","definition":"my","line":42,"localvar":"my"},{"name":"$gitcommits_query","line":43,"definition":"my","localvar":"my","containerName":"git_commit_stats","kind":13},{"name":"$gitcommits_stmt","line":44,"definition":"my","localvar":"my","containerName":"git_commit_stats","kind":13},{"name":"$dbh","containerName":"git_commit_stats","line":44,"kind":13},{"line":44,"kind":12,"name":"prepare","containerName":"git_commit_stats"},{"kind":13,"line":44,"containerName":"git_commit_stats","name":"$gitcommits_query"},{"containerName":"git_commit_stats","kind":13,"localvar":"my","name":"$date","definition":"my","line":46},{"containerName":"git_commit_stats","name":"now","kind":12,"line":46},{"containerName":"git_commit_stats","kind":13,"localvar":"my","name":"$start_year","definition":"my","line":47},{"line":47,"kind":13,"name":"$date","containerName":"git_commit_stats"},{"kind":12,"line":47,"containerName":"git_commit_stats","name":"year"},{"containerName":"git_commit_stats","name":"$gitcommits_stmt","kind":13,"line":48},{"line":48,"kind":12,"name":"execute","containerName":"git_commit_stats"},{"kind":13,"line":48,"containerName":"git_commit_stats","name":"$start_year"},{"localvar":"my","name":"$gitcommits_data","line":49,"definition":"my","containerName":"git_commit_stats","kind":13},{"line":49,"kind":13,"containerName":"git_commit_stats","name":"$gitcommits_stmt"},{"line":49,"kind":12,"containerName":"git_commit_stats","name":"fetchrow_hashref"},{"line":50,"kind":13,"containerName":"git_commit_stats","name":"@data"},{"containerName":"git_commit_stats","name":"$gitcommits_data","line":51,"kind":13},{"kind":13,"line":52,"name":"$gitcommits_data","containerName":"git_commit_stats"},{"containerName":"git_commit_stats","kind":13,"name":"$commits_data","definition":"my","line":56,"localvar":"my"},{"line":56,"kind":13,"name":"@data","containerName":"git_commit_stats"},{"name":"$self","containerName":"git_commit_stats","kind":13,"line":58},{"line":58,"kind":12,"name":"render","containerName":"git_commit_stats"},{"name":"$commits_data","containerName":"git_commit_stats","line":58,"kind":13}],"line":39,"definition":"sub","name":"git_commit_stats"},{"name":"DateTime","kind":12,"line":46},{"kind":12,"line":51,"name":"date"},{"name":"date","line":51,"kind":12},{"line":52,"kind":12,"name":"commits"},{"line":52,"kind":12,"name":"commits"},{"name":"data","line":56,"kind":12},{"name":"json","kind":12,"line":58},{"children":[{"containerName":"pod","kind":13,"localvar":"my","name":"$self","definition":"my","line":68},{"containerName":"pod","kind":13,"localvar":"my","name":"$config","line":70,"definition":"my"},{"line":70,"kind":12,"name":"new","containerName":"pod"},{"localvar":"my","name":"$module","definition":"my","line":72,"containerName":"pod","kind":13},{"containerName":"pod","name":"$self","kind":13,"line":72},{"line":72,"kind":12,"containerName":"pod","name":"param"},{"localvar":"my","definition":"my","line":73,"name":"$pod_score","kind":13,"containerName":"pod"},{"line":73,"kind":13,"name":"$self","containerName":"pod"},{"kind":12,"line":73,"name":"param","containerName":"pod"},{"name":"$pod_score","containerName":"pod","kind":13,"line":75},{"localvar":"my","definition":"my","line":76,"name":"$summary_query","kind":13,"containerName":"pod"},{"localvar":"my","name":"$summary_stmt","definition":"my","line":77,"containerName":"pod","kind":13},{"line":77,"kind":13,"containerName":"pod","name":"$dbh"},{"kind":12,"line":77,"name":"prepare","containerName":"pod"},{"name":"$summary_query","containerName":"pod","kind":13,"line":77},{"line":78,"kind":13,"name":"$summary_stmt","containerName":"pod"},{"containerName":"pod","name":"execute","line":78,"kind":12},{"line":78,"kind":13,"name":"$module","containerName":"pod"},{"containerName":"pod","kind":13,"localvar":"my","name":"$is_our_module","line":80,"definition":"my"},{"kind":13,"line":80,"containerName":"pod","name":"$my_pod_score"},{"name":"$summary_stmt","containerName":"pod","line":80,"kind":13},{"kind":12,"line":80,"containerName":"pod","name":"fetchrow_array"},{"line":81,"kind":13,"containerName":"pod","name":"$is_our_module"},{"containerName":"pod","name":"$self","line":82,"kind":13},{"kind":12,"line":82,"name":"res","containerName":"pod"},{"kind":12,"line":82,"containerName":"pod","name":"code"},{"kind":13,"line":82,"containerName":"pod","name":"$self"},{"containerName":"pod","name":"redirect_to","line":82,"kind":12},{"name":"$pod_score","containerName":"pod","kind":13,"line":84},{"name":"$my_pod_score","containerName":"pod","kind":13,"line":84},{"localvar":"my","line":87,"definition":"my","name":"$output","kind":13,"containerName":"pod"},{"containerName":"pod","name":"$pod_score","line":88,"kind":13},{"containerName":"pod","kind":13,"name":"$path","line":89,"definition":"my","localvar":"my"},{"name":"new","containerName":"pod","kind":12,"line":89},{"name":"inc","containerName":"pod","line":89,"kind":12},{"containerName":"pod","name":"verbose","kind":12,"line":89},{"name":"find","containerName":"pod","kind":12,"line":89},{"line":89,"kind":13,"name":"$module","containerName":"pod"},{"kind":13,"line":89,"name":"$config","containerName":"pod"},{"line":89,"kind":12,"containerName":"pod","name":"get"},{"line":91,"definition":"my","name":"$parser","localvar":"my","kind":13,"containerName":"pod"},{"containerName":"pod","name":"new","kind":12,"line":91},{"containerName":"pod","name":"$parser","line":92,"kind":13},{"line":93,"kind":13,"containerName":"pod","name":"$parser"},{"kind":12,"line":93,"name":"anchor_items","containerName":"pod"},{"line":94,"kind":13,"name":"$parser","containerName":"pod"},{"line":94,"kind":12,"containerName":"pod","name":"index"},{"line":95,"kind":13,"containerName":"pod","name":"$parser"},{"line":95,"kind":12,"name":"perldoc_url_prefix","containerName":"pod"},{"kind":13,"line":96,"containerName":"pod","name":"$parser"},{"kind":12,"line":96,"containerName":"pod","name":"output_string"},{"kind":13,"line":96,"name":"$output","containerName":"pod"},{"line":97,"kind":13,"name":"$parser","containerName":"pod"},{"name":"parse_file","containerName":"pod","line":97,"kind":12},{"name":"$path","containerName":"pod","line":97,"kind":13},{"line":100,"kind":13,"name":"$output","containerName":"pod"},{"line":101,"kind":13,"containerName":"pod","name":"$output"},{"line":102,"kind":13,"containerName":"pod","name":"$output"},{"containerName":"pod","name":"$output","kind":13,"line":103},{"name":"$output","containerName":"pod","kind":13,"line":104},{"line":105,"kind":13,"name":"$output","containerName":"pod"},{"line":106,"kind":13,"name":"$output","containerName":"pod"}],"definition":"sub","line":67,"signature":{"parameters":[{"label":"$self"}],"label":"pod($self)","documentation":"1;\npackage Pki::Controller::Pki;\nuse Mojo::Base 'Mojolicious::Controller';\n\nuse Config::JSON;\nuse Data::Printer;\nuse DateTime;\nuse JSON;\nuse Pod::Simple::Search;\nuse MetaCPAN::Pod::XHTML;\n\nuse DBI;\nmy $dbh = DBI->connect(\"dbi:SQLite:critic.db\",\"\",\"\") or die \"Could not connect\";\n\n=head2 critic\n\n\nsub critic {\n  my ( $self ) = @_;\n\n  my $module = $self->param( 'module' );\n  my @critics;\n\n  my $critic_query = \"select module, critic, line_number, source, explanation from critic where module = ?\";\n  my $critic_stmt  = $dbh->prepare( $critic_query );\n  $critic_stmt->execute( $module );\n  while ( my ( $module, $critic, $line_number, $source, $explanation ) = $critic_stmt->fetchrow_array ) {\n    push @critics, { line_number => $line_number, critic => $critic, source => $source, explanation => $explanation };\n  }\n\n  my $critic_data = { data => \\@critics };\n\n  $self->render(json => $critic_data);\n}\n\n=head2 git_commit_stats\n\n\nsub git_commit_stats {\n  my $self = shift;\n\n  my @data;\n  my $gitcommits_query = \"select * from gitcommits where date >= ?\";\n  my $gitcommits_stmt = $dbh->prepare( $gitcommits_query );\n\n  my $date = DateTime->now();\n  my $start_year = $date->year - 1;\n  $gitcommits_stmt->execute( $start_year .'-01-01' );\n  while ( my $gitcommits_data = $gitcommits_stmt->fetchrow_hashref ) {\n    push @data, { \n      date    => $gitcommits_data->{ date },\n      commits => $gitcommits_data->{ commits }\n    };\n  }\n\n  my $commits_data = { data => \\@data };\n\n  $self->render(json => $commits_data);\n}\n\n=head2 pod\n\nRetrieve POD, dependency data, inheritance data and gitlog data - render template."},"name":"pod","kind":12,"detail":"($self)","containerName":"Pki::Controller::Pki","range":{"start":{"line":67,"character":0},"end":{"line":107,"character":9999}}},{"kind":12,"line":70,"containerName":"JSON","name":"Config"},{"containerName":"Simple::Search","name":"Pod","line":89,"kind":12},{"name":"MetaCPAN","containerName":"Pod::XHTML","line":91,"kind":12},{"definition":"my","line":109,"name":"$dependency_data","localvar":"my","kind":13,"containerName":null},{"containerName":null,"name":"$inheritance_data","line":109,"kind":13},{"kind":13,"line":109,"containerName":null,"name":"$self"},{"kind":12,"line":109,"name":"_info","containerName":"Pki::Controller::Pki"},{"kind":13,"line":109,"containerName":null,"name":"$module"},{"localvar":"my","name":"$gitlog","line":110,"definition":"my","containerName":null,"kind":13},{"kind":13,"line":110,"name":"$self","containerName":null},{"line":110,"kind":12,"containerName":"Pki::Controller::Pki","name":"_gitlog"},{"containerName":null,"name":"$module","kind":13,"line":110},{"containerName":null,"name":"$self","kind":13,"line":113},{"containerName":"Pki::Controller::Pki","name":"render","kind":12,"line":113},{"name":"template","line":114,"kind":12},{"kind":12,"line":115,"name":"pod"},{"containerName":null,"name":"$output","line":115,"kind":13},{"name":"pod_score","line":116,"kind":12},{"line":116,"kind":13,"containerName":null,"name":"$pod_score"},{"line":117,"kind":12,"name":"dependencies"},{"containerName":null,"name":"$dependency_data","kind":13,"line":117},{"name":"inheritance","kind":12,"line":118},{"kind":13,"line":118,"name":"$inheritance_data","containerName":null},{"name":"gitlog","kind":12,"line":119},{"line":120,"kind":13,"name":"$gitlog","containerName":null},{"children":[{"containerName":"summary","kind":13,"name":"$self","line":129,"definition":"my","localvar":"my"},{"containerName":"summary","kind":13,"name":"@modules","definition":"my","line":131,"localvar":"my"},{"kind":13,"containerName":"summary","localvar":"my","definition":"my","line":132,"name":"$summary_query"},{"name":"$summary_stmt","line":133,"definition":"my","localvar":"my","containerName":"summary","kind":13},{"name":"$dbh","containerName":"summary","line":133,"kind":13},{"kind":12,"line":133,"name":"prepare","containerName":"summary"},{"containerName":"summary","name":"$summary_query","kind":13,"line":133},{"kind":13,"line":135,"containerName":"summary","name":"$summary_stmt"},{"containerName":"summary","name":"execute","line":135,"kind":12},{"kind":13,"containerName":"summary","localvar":"my","line":136,"definition":"my","name":"$summary_data"},{"kind":13,"line":136,"name":"$summary_stmt","containerName":"summary"},{"containerName":"summary","name":"fetchrow_hashref","kind":12,"line":136},{"name":"@modules","containerName":"summary","line":137,"kind":13},{"containerName":"summary","name":"$summary_data","line":138,"kind":13},{"line":140,"kind":13,"name":"$summary_data","containerName":"summary"},{"kind":13,"line":140,"name":"$summary_data","containerName":"summary"},{"kind":13,"line":141,"name":"$summary_data","containerName":"summary"},{"name":"$summary_data","containerName":"summary","line":141,"kind":13},{"containerName":"summary","name":"$summary_data","kind":13,"line":142},{"name":"$summary_data","containerName":"summary","kind":13,"line":143},{"containerName":"summary","name":"$summary_data","line":144,"kind":13},{"line":144,"kind":13,"name":"$summary_data","containerName":"summary"},{"line":146,"kind":13,"name":"$summary_data","containerName":"summary"},{"containerName":"summary","kind":13,"localvar":"my","name":"$table_data","line":150,"definition":"my"},{"name":"@modules","containerName":"summary","line":150,"kind":13},{"name":"$self","containerName":"summary","kind":13,"line":152},{"line":152,"kind":12,"containerName":"summary","name":"render"},{"kind":13,"line":152,"name":"$table_data","containerName":"summary"}],"line":128,"definition":"sub","name":"summary","kind":12,"containerName":"Pki::Controller::Pki","range":{"end":{"line":153,"character":9999},"start":{"line":128,"character":0}}},{"line":138,"kind":12,"name":"module"},{"name":"module","kind":12,"line":138},{"name":"compiles","kind":12,"line":139},{"kind":12,"line":140,"name":"max_complexity"},{"name":"max_complexity","kind":12,"line":140},{"name":"max_complexity","kind":12,"line":140},{"name":"avg_complexity","line":141,"kind":12},{"line":141,"kind":12,"name":"avg_complexity"},{"line":141,"kind":12,"name":"avg_complexity"},{"kind":12,"line":142,"name":"lines"},{"line":142,"kind":12,"name":"lines"},{"line":143,"kind":12,"name":"subs"},{"name":"sub_count","kind":12,"line":143},{"name":"pod","line":144,"kind":12},{"name":"module","kind":12,"line":144},{"line":144,"kind":12,"name":"pod"},{"name":"hierarchy","line":145,"kind":12},{"name":"critic","kind":12,"line":146},{"kind":12,"line":146,"name":"module"},{"name":"data","kind":12,"line":150},{"line":152,"kind":12,"name":"json"},{"children":[{"containerName":"welcome","kind":13,"name":"$self","line":160,"definition":"my","localvar":"my"},{"name":"$self","containerName":"welcome","kind":13,"line":163},{"containerName":"welcome","name":"render","kind":12,"line":163}],"name":"welcome","definition":"sub","line":159,"range":{"start":{"character":0,"line":159},"end":{"character":9999,"line":164}},"containerName":"Pki::Controller::Pki","kind":12},{"name":"template","kind":12,"line":163},{"containerName":"Pki::Controller::Pki","detail":"($self,$module)","range":{"end":{"character":9999,"line":180},"start":{"character":0,"line":168}},"kind":12,"name":"_gitlog","definition":"sub","line":168,"signature":{"parameters":[{"label":"$self"},{"label":"$module"}],"label":"_gitlog($self,$module)","documentation":""},"children":[{"localvar":"my","name":"$self","definition":"my","line":169,"containerName":"_gitlog","kind":13},{"kind":13,"line":169,"containerName":"_gitlog","name":"$module"},{"localvar":"my","definition":"my","line":172,"name":"$gitlog_query","kind":13,"containerName":"_gitlog"},{"definition":"my","line":173,"name":"$gitlog_stmt","localvar":"my","kind":13,"containerName":"_gitlog"},{"name":"$dbh","containerName":"_gitlog","line":173,"kind":13},{"containerName":"_gitlog","name":"prepare","kind":12,"line":173},{"line":173,"kind":13,"containerName":"_gitlog","name":"$gitlog_query"},{"name":"$gitlog_stmt","containerName":"_gitlog","line":174,"kind":13},{"kind":12,"line":174,"containerName":"_gitlog","name":"execute"},{"containerName":"_gitlog","name":"$module","kind":13,"line":174},{"containerName":"_gitlog","kind":13,"name":"$module_name","definition":"my","line":175,"localvar":"my"},{"kind":13,"line":175,"containerName":"_gitlog","name":"$gitlog_data"},{"kind":13,"line":175,"name":"$gitlog_stmt","containerName":"_gitlog"},{"kind":12,"line":175,"name":"fetchrow_array","containerName":"_gitlog"},{"name":"$gitlog_data","containerName":"_gitlog","line":176,"kind":13},{"name":"$gitlog_data","containerName":"_gitlog","kind":13,"line":177},{"containerName":"_gitlog","name":"$gitlog_data","kind":13,"line":179}]},{"kind":12,"range":{"start":{"line":182,"character":0},"end":{"character":9999,"line":200}},"containerName":"Pki::Controller::Pki","detail":"($self,$module)","signature":{"parameters":[{"label":"$self"},{"label":"$module"}],"label":"_info($self,$module)","documentation":""},"line":182,"definition":"sub","name":"_info","children":[{"kind":13,"containerName":"_info","line":183,"definition":"my","name":"$self","localvar":"my"},{"name":"$module","containerName":"_info","line":183,"kind":13},{"localvar":"my","definition":"my","line":186,"name":"$dependency_query","kind":13,"containerName":"_info"},{"name":"$dependency_stmt","line":187,"definition":"my","localvar":"my","containerName":"_info","kind":13},{"line":187,"kind":13,"name":"$dbh","containerName":"_info"},{"line":187,"kind":12,"containerName":"_info","name":"prepare"},{"line":187,"kind":13,"name":"$dependency_query","containerName":"_info"},{"name":"$dependency_stmt","containerName":"_info","kind":13,"line":188},{"name":"execute","containerName":"_info","kind":12,"line":188},{"kind":13,"line":188,"name":"$module","containerName":"_info"},{"name":"$module_name","line":189,"definition":"my","localvar":"my","containerName":"_info","kind":13},{"containerName":"_info","name":"$dependency_jsondata","kind":13,"line":189},{"name":"$dependency_stmt","containerName":"_info","line":189,"kind":13},{"containerName":"_info","name":"fetchrow_array","kind":12,"line":189},{"containerName":"_info","kind":13,"name":"$dependency_data","line":190,"definition":"my","localvar":"my"},{"name":"$dependency_jsondata","containerName":"_info","line":190,"kind":13},{"containerName":"_info","kind":13,"name":"$inheritance_query","line":193,"definition":"my","localvar":"my"},{"kind":13,"containerName":"_info","localvar":"my","line":194,"definition":"my","name":"$inheritance_stmt"},{"line":194,"kind":13,"name":"$dbh","containerName":"_info"},{"name":"prepare","containerName":"_info","kind":12,"line":194},{"containerName":"_info","name":"$inheritance_query","line":194,"kind":13},{"name":"$inheritance_stmt","containerName":"_info","kind":13,"line":195},{"name":"execute","containerName":"_info","line":195,"kind":12},{"containerName":"_info","name":"$module","kind":13,"line":195},{"localvar":"my","name":"$inheritance_module","line":196,"definition":"my","containerName":"_info","kind":13},{"line":196,"kind":13,"name":"$inheritance_jsondata","containerName":"_info"},{"containerName":"_info","name":"$inheritance_stmt","kind":13,"line":196},{"kind":12,"line":196,"containerName":"_info","name":"fetchrow_array"},{"localvar":"my","name":"$inheritance_data","line":197,"definition":"my","containerName":"_info","kind":13},{"kind":13,"line":197,"containerName":"_info","name":"$inheritance_jsondata"},{"kind":13,"line":199,"containerName":"_info","name":"$dependency_data"},{"name":"$inheritance_data","containerName":"_info","kind":13,"line":199}]},{"line":190,"kind":12,"name":"decode_json"},{"name":"decode_json","kind":12,"line":197}]}